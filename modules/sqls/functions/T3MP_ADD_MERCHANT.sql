CREATE OR REPLACE PROCEDURE T3MP_ADD_MERCHANT(
  p_institution_number in VARCHAR2,
  p_client_number in VARCHAR2 DEFAULT '',
  p_group_number in VARCHAR2 DEFAULT '',
  p_parent_client_number in VARCHAR2 DEFAULT '',
  p_client_name in VARCHAR2 DEFAULT 'Test merchant',
  p_client_email in VARCHAR2 DEFAULT 'hung.ho@rs2.com')
AS
  v_client_number  varchar(8) := p_client_number;
  v_group_number  varchar(8) := p_group_number;
  v_parent_client_number varchar(8) := p_parent_client_number;
  v_record_date  varchar(8) := '';
  V_INIT_RETURN PLS_INTEGER;
BEGIN
  BW_PRC_RES.INITGLOBALVARS (p_institution_number, 129, 999999, V_INIT_RETURN);

  if (v_record_date is null or v_record_date = '') then
    SELECT POSTING_DATE INTO v_record_date FROM SYS_POSTING_DATE WHERE INSTITUTION_NUMBER = p_institution_number AND STATION_NUMBER = 129; -- posting date
  end if;

  if (v_client_number is null or v_client_number = '') then
    v_client_number := BW_CODE_LIBRARY.GETNEXTSEQNUMBER('010',1);
  end if;

  if (v_group_number is null or v_group_number = '') then
      v_group_number := BW_CODE_LIBRARY.GETNEXTSEQNUMBER('018',1);
  end if;

   if (v_parent_client_number is null or v_parent_client_number = '') then
      v_parent_client_number := p_institution_number;
  end if;

  Insert into CIS_CLIENT_DETAILS (RECORD_DATE,INSTITUTION_NUMBER,CLIENT_NUMBER,LAST_NAME,FIRST_NAME,BIRTH_NAME,CONTACT_NAME,TITLE,MARITAL_STATUS,TEL_PRIVATE,TEL_WORK,FAX_PRIVATE,FAX_WORK,ID_NUMBER,PASSPORT_NUMBER,VAT_REG_NUMBER,DRIVING_LICENSE,REGISTRATION_NUMBER,CLIENT_COUNTRY,BIRTH_DATE,BIRTH_PLACE,NATIONALITY,CLIENT_TYPE,RESIDENCE_STATUS,RESIDENCE_STATUS_DATE,FATHERS_NAME,CLIENT_LANGUAGE,INSTITUTION_ACCT_OFFICER,PROVIDER_ACCT_OFFICER,LAST_AMENDMENT_DATE,CLIENT_STATUS,AUDIT_TRAIL,SHORT_NAME,COMPANY_NAME,LEGAL_FORM,TRADE_NAME,BUSINESS_CLASS,EMPLOYMENT_STATUS,CLIENT_CITY,OUR_REFERENCE,RECORD_TYPE,REGISTRATION_DATE,RESIDENCE_TYPE,EMPLOYMENT_POSITION,EMPLOYER_NAME,EMPLOYMENT_DATE,INCOME_RANGE,EMPLOYMENT_EXTRA_INFO,MARITAL_STATUS_DATE,CLIENT_CLASSIFICATION,MOTHER_MAIDEN_NAME,POST_CODE,CLIENT_STATE,CLIENT_PASSWORD,CLIENT_NUMBER_RBS,MERCHANT_STREET,CLIENT_GENDER,CLIENT_REGION,CLIENT_BRANCH,ID_TYPE,ID_EXPIRY_2,FIRST_NAME_L2,FATHERS_NAME_L2,GRANDFATHERS_NAME,GRANDFATHERS_NAME_L2,LAST_NAME_L2,SHORT_NAME_L2,BIRTH_DATE_2,NO_OF_DEPENDANTS,CREDIT_SCORE_STATUS,SCORE_DATE,TOTAL_SCORE,EDUCATION_LEVEL,ID_EXPIRY_DATE,CARD_RELATION,TRADE_NAME_L2,COMPANY_NAME_L2,REGISTRATION_EXPIRY_DATE,SAMA_REFERENCE,RCC,CREDIT_DELTA_INDICATOR,SERVICE_TEL_NUMBER,CROSS_BORDER_FEE_IND,ECOMMERCE_INDICATOR,LOCKING_COUNTER,ACCUMULATOR_SCHEME,MC_IP_QUALIFICATION,MC_IP_VALUE,VISA_IP_QUALIFICATION,VISA_IP_VALUE,DOMESTIC_MCC,BILLBACK_INDICATOR,VIRTUAL_RBS_ACCT_NUMBER,MC_TIER_LEVEL,VISA_THRESHOLD,SUPER_GROUP,RT_FLAG,INCOME_AMOUNT,WEBSITE_ADDRESS,PARENT_CLIENT_NUMBER_RBS,CNAE,FATCA,GREEN_CARD,MOBILE_NO_1,MOBILE_NO_2,FEE_PROGRAM_INDICATOR,MIDDLE_NAME,VAT_REGION,VAT_COUNTRY,DINERS_INTES_CODE,CONTRACT_REGION,BIRTH_COUNTRY,LEGAL_DOCUMENT_EXPIRY_DATE,DOCUMENTS_RECEIVED,SEC_VAT_REG_NUMBER,SEC_REGISTRATION_NUMBER,ABU,SUB_ACQUIRER_FLAG,DEBIT_BALANCE_ANALYSIS_FLAG,OPERATION_STATUS,RECEIVER_END_USER_TYPE,ISPB) values ('20230217',p_institution_number,v_client_number,'Test','Merchant',null,p_client_name,null,null,null,null,null,null,null,null,'12345565222411',null,'11111111111111','280',null,null,null,'002','001',null,null,'001','000',null,'20230217','001','23048-095127-999999-129-99999-00003',p_client_name,p_client_name,'006',p_client_name,'0000',null,'Frankfurt', '0000000' || v_client_number,'003',null,null,null,null,null,null,null,null,null,null,null,null,null,null,'NeuIsenburg',null,'000',null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,'798',null,null,'000','999','0','000','000',null,'000',null,'0000',null,null,null,null,null,null,null,null,null,null,null,null,null,null,'000',null,null,null,null,'999',null,null,null,null,null,'001',null,null,null,null,null);
  Insert into CIS_CLIENT_LINKS (RECORD_DATE,INSTITUTION_NUMBER,GROUP_NUMBER,CLIENT_NUMBER,EFFECTIVE_DATE,EXPIRY_DATE,CONTRACT_STATUS,PARENT_CLIENT_NUMBER,CLIENT_LEVEL,AUDIT_TRAIL,SERVICE_CONTRACT_ID,CLIENT_TARIFF,CONTRACT_REFERENCE,BANK_REFERENCE,SETTLEMENT_METHOD,POSTING_METHOD,CLIENT_BRANCH,INSTITUTION_ACCT_OFFICER,PROVIDER_ACCT_OFFICER,CONTRACT_CATEGORY,COST_CENTER,CHARGE_TIER_LEVEL,CARD_RELATION,PROVIDER_ACCT_OFFICER_2,PARENT_CLIENT_NUM_RBS,RISK_GROUP,LOCKING_COUNTER,ACCUMULATOR_SCHEME,CLIENT_SCHEME,LOAN_TYPE_ID,TIER_GROUP,PREPAYMENT_IND,CLIENT_RELATION,PREPAY_EFFECTIVE_DATE,REMINDER_CLASS,REMINDER_FEE_TYPE,RESERVE_PERCENT,RELATION_CLIENT_NUMBER,RELATION_GROUP_NUMBER,FRAUD_FLAG,COLLECTION_STATUS,SALES_TURNOVER_CATEGORY,REASON_CODE,TRANSFER_METHOD,ALLOCATION_METHOD,CLIENT_TARIFF$3,CLIENT_SCHEME$3,MERCHANT_TRAN_TARIFF,MANUAL_ENTRY,FOREIGN_CARD_FLAG,FX_TARIFF,RISK_CLIENT_ID,RISK_RULE_GROUP_ID,ENTITY_ID) values ('20230217',p_institution_number,v_group_number,v_client_number,'20230217','99991231','001',v_parent_client_number,'001','23048-095127-999999-129-99999-00003','110','000301',null,null,'523','002','000','000','000','003',null,'000',null,null,null,'001',null,'000','000000',null,null,null,null,null,null,null,null,null,null,'000','022',null,'000','000001',null,null,null,'000502',null,null,'000001',null,null,'001');
  Insert into CIS_DEVICE_LINK (TERMINAL_ID,MERCHANT_ID,INSTITUTION_NUMBER,RECORD_DATE,DATE_LAST_CHANGE,CLIENT_NUMBER,TERMINAL_STATUS,SERIAL_NUMBER,TERMINAL_TYPE,CONTACT_NAME,DEVICE_CAPABILITY,LOCATION,EOD_INDICATOR,TERMINAL_CURRENCY,TERMINAL_PIN_KEY,TERMINAL_MASTER_KEY,POS_FEE_TYPE,FEE_EFFECTIVE_DATE,FEE_EXPIRY_DATE,LAST_FEE_DATE,SYSTEM_BATCH_ID,DATE_SETTLEMENT,TIME_SETTLEMENT,AUDIT_TRAIL,LOCKING_COUNTER,SEQUENCE_NUMBER,SAMA_TERMINAL_ID,CONNECTION_ID,SCHEMA_ID,DATA_ENCRYPTION_KEY,DATA_MASTER_KEY,NOTE_TEXT,INACTIVE_TIME,MANUAL_ENTRY,FOREIGN_CARD_FLAG,FIXED_ASSET_CODE,POST_CODE,POS_CITY,POS_REGION,TERMINAL_MASTER_KEY_2,DATA_ENCRYPTION_KEY_TRANSIT,BDK_INDEX,VENDOR,KEY_MANAGEMENT_TYPE,SETTLEMENT_INDICATOR,SOFTWARE_TYPE,IS_CELLULAR_SERVICE,MSCN_DESC,MSCN_NUMBER,PARTNER_ID,SETUP_SHEET,TPK_LENGTH) values ('T'||substr(v_client_number,-7,7),'0000000' || v_client_number,p_institution_number,'20230217',null,v_client_number,'001',null,'003',null,'006','Malta','005','978',null,null,'000','20230217','99991231',null,'000006','20230425','085200','23048-095127-999999-129-99999-00003',null,'00000000',null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null);
  Insert into CIS_ADDRESSES (INSTITUTION_NUMBER,CLIENT_NUMBER,ADDRESS_CATEGORY,RECORD_DATE,EFFECTIVE_DATE,EXPIRY_DATE,ADDR_LINE_1,ADDR_LINE_2,ADDR_LINE_3,ADDR_LINE_4,ADDR_LINE_5,POST_CODE,ADDR_CLIENT_CITY,CLIENT_COUNTRY,AUDIT_TRAIL,RECORD_TYPE,TEL_WORK,FAX_WORK,CONTACT_NAME,EMAIL_ADDR,DELIVERY_METHOD,GROUP_NUMBER,CLIENT_STATE,ADDR_LANGUAGE,PO_BOX,CLIENT_REGION,TEL_HOME,TEL_OTHER,TEL_MOBILE,LOCKING_COUNTER,TEL_MOBILE_2,EMAIL_ADDR_2,LATITUDE,LONGITUDE) values (p_institution_number,v_client_number,'001','20230217','20230217','99991231','NeuIsenburg',null,null,null,null,'63232','Frankfurt','280','23048-095127-999999-129-99999-00003','003','+356 27123465','+256 27456789',p_client_name,p_client_email,'000','99999999',null,null,null,null,null,null,null,null,null,null,null,null);
  Insert into CIS_SETTLEMENT_INFORMATION (RECORD_DATE,INSTITUTION_NUMBER,CLIENT_NUMBER,SETTLEMENT_CATEGORY,AUDIT_TRAIL,REUTERS_CODE,ACCT_CURRENCY,CORRESP_BANK_NUMBER,COUNTER_BANK_NUMBER,COUNTER_CLIENT_NUMBER,CORRESP_BANK_ACCOUNT,COUNTER_BANK_ACCOUNT,CONTING_LIAB_ACCOUNT,SETTLEMENT_NUMBER,NOTE_TEXT,CONFIRMATION_METHOD,BANK_CONTACT_NAME,BANK_TEL_NUMBER,PAYMENT_REFERENCE,BANK_CLEARING_NUMBER,COUNTER_BANK_NAME,COUNTER_BANK_ACCOUNT_NAME,SETTL_PERC_TOTAL,RECORD_TYPE,ACCT_NUMBER_RBS,LOCKING_COUNTER,RECEIVER_COUNTRY_CODE,COUNTER_BANK_CITY,IBAN_REFERENCE,FUNDING_NARRATIVE,REUTERS_CODE_DR,CORRESP_BANK_NUMBER_DR,COUNTER_BANK_NUMBER_DR,CORRESP_BANK_ACCOUNT_DR,COUNTER_BANK_ACCOUNT_DR,NOTE_TEXT_DR,BANK_CONTACT_NAME_DR,BANK_TEL_NUMBER_DR,COUNTER_BANK_NAME_DR,COUNTER_BANK_ACCOUNT_NAME_DR,COUNTER_BANK_CITY_DR,IBAN_REFERENCE_DR,FUNDING_NARRATIVE_DR,PAYMENT_METHOD,CLEARING_ENTITY,PAYMENT_METHOD_DR,CLEARING_ENTITY_DR,CALENDAR_DAYS,CALENDAR_DAYS_DR,COUNTER_BANK_ACCOUNT_TYPE,CALENDAR_TYPE,FUNDING_CLIENT,SEC_COUNTER_BANK_ACCOUNT,SEC_COUNTER_BANK_ACCOUNT_DR,SEC_IBAN_REFERENCE,SEC_IBAN_REFERENCE_DR,MANDATE_RECORD_ID,COUNTER_BRANCH_CODE,COUNTER_BRANCH_CODE_DR,COUNTER_BANK_ACCOUNT_TYPE_DR,LAST_AMENDED_DATE) values ('20230217',p_institution_number,v_client_number,'002','23048-095127-999999-129-99999-00003',null,'978',null,null,null,null,null,null,'02',null,'004',null,null,null,null,null,null,null,'003',null,'0','280',null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,'0','0',null,null,null,null,null,null,null,null,null,null,null,'20230217');
  Insert into CIS_SETTLEMENT_INFORMATION (RECORD_DATE,INSTITUTION_NUMBER,CLIENT_NUMBER,SETTLEMENT_CATEGORY,AUDIT_TRAIL,REUTERS_CODE,ACCT_CURRENCY,CORRESP_BANK_NUMBER,COUNTER_BANK_NUMBER,COUNTER_CLIENT_NUMBER,CORRESP_BANK_ACCOUNT,COUNTER_BANK_ACCOUNT,CONTING_LIAB_ACCOUNT,SETTLEMENT_NUMBER,NOTE_TEXT,CONFIRMATION_METHOD,BANK_CONTACT_NAME,BANK_TEL_NUMBER,PAYMENT_REFERENCE,BANK_CLEARING_NUMBER,COUNTER_BANK_NAME,COUNTER_BANK_ACCOUNT_NAME,SETTL_PERC_TOTAL,RECORD_TYPE,ACCT_NUMBER_RBS,LOCKING_COUNTER,RECEIVER_COUNTRY_CODE,COUNTER_BANK_CITY,IBAN_REFERENCE,FUNDING_NARRATIVE,REUTERS_CODE_DR,CORRESP_BANK_NUMBER_DR,COUNTER_BANK_NUMBER_DR,CORRESP_BANK_ACCOUNT_DR,COUNTER_BANK_ACCOUNT_DR,NOTE_TEXT_DR,BANK_CONTACT_NAME_DR,BANK_TEL_NUMBER_DR,COUNTER_BANK_NAME_DR,COUNTER_BANK_ACCOUNT_NAME_DR,COUNTER_BANK_CITY_DR,IBAN_REFERENCE_DR,FUNDING_NARRATIVE_DR,PAYMENT_METHOD,CLEARING_ENTITY,PAYMENT_METHOD_DR,CLEARING_ENTITY_DR,CALENDAR_DAYS,CALENDAR_DAYS_DR,COUNTER_BANK_ACCOUNT_TYPE,CALENDAR_TYPE,FUNDING_CLIENT,SEC_COUNTER_BANK_ACCOUNT,SEC_COUNTER_BANK_ACCOUNT_DR,SEC_IBAN_REFERENCE,SEC_IBAN_REFERENCE_DR,MANDATE_RECORD_ID,COUNTER_BRANCH_CODE,COUNTER_BRANCH_CODE_DR,COUNTER_BANK_ACCOUNT_TYPE_DR,LAST_AMENDED_DATE) values ('20230217',p_institution_number,v_client_number,'001','23048-095127-999999-129-99999-00003',null,'978',null,'0000003915',null,null,'DE6565656565656',null,'01',null,'004',null,null,null,'JEEREREREE3',null,'M. Payment acct',null,'003',null,'0','280',null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,'0','0',null,null,p_institution_number,null,null,null,null,null,null,null,null,'20230217');

  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'009','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'102','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'107','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'301','Glenn Test',null,null,'003',null,null,null,'000502','20230201',null,'022',null,null,null,null,null,'0','99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'201','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'202','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'300','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);
  Insert into SVC_CLIENT_SERVICE (RECORD_DATE,INSTITUTION_NUMBER,EMBOSS_LINE_1,EMBOSS_LINE_2,SERVICE_STATUS,EXPIRY_DATE,CLIENT_NUMBER,SERVICE_CONTRACT_ID,GROUP_NUMBER,SERVICE_ID,AUDIT_TRAIL,SERVICE_NUMBER,ENCRYPTED_PIN,RECORD_TYPE,SERVICE_LEVEL,EXTENDED_SERVICE,SERVICE_PASSWORD,CLIENT_TARIFF,EFFECTIVE_DATE,SERVICE_MISC_DATA1,SERVICE_CATEGORY,ORIGINAL_EFFECTIVE_DATE,LAST_FEE_DATE,PVV,PVKI,EFFECTIVE_TIME,LOCKING_COUNTER,REVIEW_DATE,NO_OF_INSTALLMENTS,CLIENT_TARIFF$3,INSURANCE_CURRENCY,INSURANCE_CURRENCY_AMOUNT,INSOLVENCY_EVENT_DATE,STATUS_REASON,AIR_MILES_NO) values ('20230201',p_institution_number,p_client_name,null,'001','99991231',v_client_number,'110',v_group_number,'109','23048-095127-999999-129-99999-00003',null,null,'003',null,null,null,'000502','20230201',null,'002',null,null,null,null,null,null,'99991231',null,null,null,null,null,null,null);

  Insert into CAS_CLIENT_ACCOUNT (ACCT_NUMBER,ACCT_NUMBER_RBS,INSTITUTION_NUMBER,CLIENT_NUMBER,GROUP_NUMBER,LIMIT_NUMBER,SERVICE_CONTRACT_ID,ACCOUNT_TYPE_ID,ACCT_CURRENCY,BILLING_CYCLE,RECORD_DATE,ACCT_STATUS,LAST_STATEMENT_DATE,UNALLOCATED_CREDITS,LAST_STATEMENT_NUMBER,GL_NUMBER,PARENT_ACCOUNT_NUMBER,LAST_UPDATE_RBS,ACCOUNT_LEVEL,AUDIT_TRAIL,RECORD_TYPE,CLIENT_ACCOUNT_NAME,BILLING_LEVEL,SETTLEMENT_NUMBER,LAST_SETTLEMENT_DATE,LAST_ACCRUAL_DATE,FRAUD_FLAG,LAST_FEE_DATE,CLIENT_LEVEL,PARENT_CLIENT_NUMBER,OVERRIDE_EXPIRY,STATEMENT_TYPE,STATEMENT_GENERATION,LAST_AMENDED_DATE,BILLING_CYCLE_ID,CURRENT_CYCLE_START,CURRENT_CYCLE_END,PAYMENT_STATUS,ACTIVE_DATE,LOCKING_COUNTER,PAYMENT_BANK_CLIENT,PAYMENT_ACCT_NUMBER,CENTRALIZED_ACCOUNT,CLIENT_BRANCH,LOCKIN_EXPIRY_DATE,LOCKIN_START_DATE,LAST_OPEN_PAYMENT_DATE,LAST_ACCRUAL_DATE_DR,GLOBAL_LIMIT_NUMBER,LAST_ACCRUAL_DATE_CR,CIS_ID,INVOICES,ACCOUNT_SELLER,PREPAYMENT_ID,ALLOCATION_RULE,ACCOUNT_BASE_ID,BANK_ACCT_TYPE,CBU,OTHER_DATA,LAST_PAYMENT_VALUE_DATE,REF_COLLECTION_ACCT,REF_COLLECTION_ACCT_NUMBER,SEC_ACCT_NUMBER_RBS) values (v_client_number || '001',null,p_institution_number,v_client_number,v_group_number,null,'110','012','978','301','20230217','001',null,'0','00000098',null,v_parent_client_number || '001','20230217','002','23048-095127-999999-129-99999-00003','003',p_client_name,'001','01','20230302','20230131','000',null,'001',v_parent_client_number,null,'900','001',null,null,'20230501','20230531',null,'20230217',null,null,null,null,null,null,null,null,'20230217',null,'20230217',null,null,null,null,null,null,null,null,null,'20230302',null,null,null);
  Insert into CAS_CLIENT_ACCOUNT (ACCT_NUMBER,ACCT_NUMBER_RBS,INSTITUTION_NUMBER,CLIENT_NUMBER,GROUP_NUMBER,LIMIT_NUMBER,SERVICE_CONTRACT_ID,ACCOUNT_TYPE_ID,ACCT_CURRENCY,BILLING_CYCLE,RECORD_DATE,ACCT_STATUS,LAST_STATEMENT_DATE,UNALLOCATED_CREDITS,LAST_STATEMENT_NUMBER,GL_NUMBER,PARENT_ACCOUNT_NUMBER,LAST_UPDATE_RBS,ACCOUNT_LEVEL,AUDIT_TRAIL,RECORD_TYPE,CLIENT_ACCOUNT_NAME,BILLING_LEVEL,SETTLEMENT_NUMBER,LAST_SETTLEMENT_DATE,LAST_ACCRUAL_DATE,FRAUD_FLAG,LAST_FEE_DATE,CLIENT_LEVEL,PARENT_CLIENT_NUMBER,OVERRIDE_EXPIRY,STATEMENT_TYPE,STATEMENT_GENERATION,LAST_AMENDED_DATE,BILLING_CYCLE_ID,CURRENT_CYCLE_START,CURRENT_CYCLE_END,PAYMENT_STATUS,ACTIVE_DATE,LOCKING_COUNTER,PAYMENT_BANK_CLIENT,PAYMENT_ACCT_NUMBER,CENTRALIZED_ACCOUNT,CLIENT_BRANCH,LOCKIN_EXPIRY_DATE,LOCKIN_START_DATE,LAST_OPEN_PAYMENT_DATE,LAST_ACCRUAL_DATE_DR,GLOBAL_LIMIT_NUMBER,LAST_ACCRUAL_DATE_CR,CIS_ID,INVOICES,ACCOUNT_SELLER,PREPAYMENT_ID,ALLOCATION_RULE,ACCOUNT_BASE_ID,BANK_ACCT_TYPE,CBU,OTHER_DATA,LAST_PAYMENT_VALUE_DATE,REF_COLLECTION_ACCT,REF_COLLECTION_ACCT_NUMBER,SEC_ACCT_NUMBER_RBS) values (v_client_number || '003',null,p_institution_number,v_client_number,v_group_number,null,'110','007','840','301','20230217','001','00000000','0',null,null,v_parent_client_number || '003',null,'002','23048-102611-999999-129-99999-00009','003',p_client_name,'001','00','00000000','20230131',null,null,'001',v_parent_client_number,null,'900','900',null,null,'20230501','20230531',null,'20230217','0',null,null,null,null,null,null,null,'20230217',null,'20230217',null,null,null,null,null,null,null,null,null,null,null,null,null);
  COMMIT;
 	
  dbms_output.put_line('Successfully created merchant:' || v_client_number || ' application:' || p_institution_number);
EXCEPTION when others then
     dbms_output.put_line('> ERROR CREATE_CLIENT: '|| sqlerrm || ' ' || dbms_utility.format_error_backtrace);rollback;
END;
